---
// Header component - Mobile first, full nav at lg (1512px)
const navLinks = [
  { label: "Home", href: "/" },
  { label: "About us", href: "/about" },
  { label: "Contact", href: "/contact" },
  { label: "Blog", href: "/blog" },
];
---

<header class="header flex items-center justify-between py-6 px-(--spacing-container) lg:px-0 fixed top-0 left-1/2 -translate-x-1/2 w-full max-w-(--max-width-site) z-50 transition-transform duration-300 before:content-[''] before:absolute before:inset-0 before:left-1/2 before:-translate-x-1/2 before:w-screen before:-z-10 before:bg-(--color-bg-section)">
  <!-- Logo -->
  <a href="/" class="flex items-center" aria-label="Accueil">
    <img src="/logoMerly.svg" alt="Merly" class="block w-[75px] md:w-[100px] h-auto" width="100" height="30" />
  </a>

  <!-- Navigation - visible at lg, centered -->
  <nav class="hidden lg:flex lg:gap-8 lg:absolute lg:left-1/2 lg:-translate-x-1/2">
    {navLinks.map((link) => (
      <a href={link.href} class="text-(--color-text) no-underline transition-opacity hover:opacity-70">{link.label}</a>
    ))}
  </nav>

  <!-- CTAs - visible at lg -->
  <div class="hidden lg:flex lg:items-center lg:gap-8">
    <a href="/simulate" class="text-(--color-text) transition-opacity border-b hover:opacity-70">Simulate your investment</a>
    <a href="/register" class="btn-outline !w-auto !py-3">Get started</a>
  </div>

  <!-- Burger - hidden at lg -->
  <button
    class="burger flex flex-col justify-center gap-[3px] w-[30px] h-[10px] p-0 bg-transparent border-none cursor-pointer focus-visible:outline-2 focus-visible:outline-current focus-visible:outline-offset-4 lg:hidden"
    type="button"
    aria-label="Ouvrir le menu"
    aria-expanded="false"
    aria-controls="mobile-nav"
  >
    <span class="burger-line block w-full h-px bg-current transition-all duration-300"></span>
    <span class="burger-line block w-full h-px bg-current transition-all duration-300"></span>
    <span class="burger-line block w-full h-px bg-current transition-all duration-300"></span>
  </button>
</header>

<style>
  /* Header hide on scroll down */
  .header.header-hidden {
    transform: translateY(-100%);
  }

  /* États du burger - nécessite CSS pour aria-expanded */
  .burger[aria-expanded="true"] .burger-line:nth-child(1) {
    transform: translateY(4px) rotate(45deg);
  }
  .burger[aria-expanded="true"] .burger-line:nth-child(2) {
    opacity: 0;
  }
  .burger[aria-expanded="true"] .burger-line:nth-child(3) {
    transform: translateY(-4px) rotate(-45deg);
  }
</style>

<script>
  const burger = document.querySelector('.burger');
  const header = document.querySelector('.header');

  burger?.addEventListener('click', () => {
    const isExpanded = burger.getAttribute('aria-expanded') === 'true';
    burger.setAttribute('aria-expanded', String(!isExpanded));
    burger.setAttribute('aria-label', isExpanded ? 'Ouvrir le menu' : 'Fermer le menu');
  });

  // Hide header on scroll down, show on scroll up
  let lastScrollY = window.scrollY;

  window.addEventListener('scroll', () => {
    const currentScrollY = window.scrollY;

    if (currentScrollY > lastScrollY && currentScrollY > 100) {
      // Scrolling down & past threshold
      header?.classList.add('header-hidden');
    } else {
      // Scrolling up
      header?.classList.remove('header-hidden');
    }

    lastScrollY = currentScrollY;
  }, { passive: true });
</script>
