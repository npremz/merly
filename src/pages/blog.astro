---
import Layout from '../layouts/Layout.astro';
import { Image } from 'astro:assets';
import AnimatedBackground from '../components/ui/AnimatedBackground.astro';
import blog01 from '../assets/images/blog_hd_1.jpg';
import blog02 from '../assets/images/blog_hd_2.jpg';
import blog03 from '../assets/images/blog_hd_3.jpg';
import blog04 from '../assets/images/blog_hd_4.jpg';
import blog05 from '../assets/images/blog_hd_5.jpg';
import resultImg from '../assets/images/blog_hd_6.jpg';

const blogArticles = [
  { date: "15.01.26", title: "PER ou Assurance-vie : Comment choisir le bon véhicule pour préparer sa retraite en 2026.", image: blog01, slug: "per-assurance-vie-retraite" },
  { date: "08.01.26", title: "Transmission de patrimoine : Les stratégies pour anticiper et optimiser la succession.", image: blog02, slug: "transmission-patrimoine-succession" },
  { date: "20.12.25", title: "Investissement immobilier locatif : LMNP, SCI, nue-propriété, quel montage choisir ?", image: blog03, slug: "investissement-immobilier-locatif" },
  { date: "12.12.25", title: "Réduire son IFI : Les leviers légaux pour optimiser l'impôt sur la fortune immobilière.", image: blog04, slug: "reduire-ifi-optimisation" },
  { date: "01.12.25", title: "Le démembrement de propriété : un outil puissant pour la transmission de patrimoine.", image: blog05, slug: "demembrement-propriete" },
];

const guidesArticles = [
  { date: "28.11.25", title: "Guide complet : Optimiser sa déclaration de revenus et les réductions d'impôt méconnus.", image: resultImg, slug: "optimiser-declaration-revenus" },
  { date: "15.11.25", title: "Guide complet : Protection du conjoint - Donation au dernier vivant et autres dispositifs.", image: resultImg, slug: "protection-conjoint" },
  { date: "02.11.25", title: "Guide complet : SCPI - Comment diversifier son patrimoine immobilier sans gestion.", image: resultImg, slug: "scpi-diversification" },
  { date: "18.10.25", title: "Guide complet : PEE et PERCO - Maximiser les avantages de l'épargne salariale.", image: resultImg, slug: "pee-perco-epargne-salariale" },
  { date: "05.10.25", title: "Guide complet : Expatriation et patrimoine - Les points de vigilance fiscaux et juridiques.", image: resultImg, slug: "expatriation-patrimoine" },
];
---

<Layout title="Ressources - Merly Patrimoine">
  <div class="relative">
    <AnimatedBackground />

    <!-- Hero Title -->
    <section class="section section-bg-transparent pt-16 md:pt-32 lg:pt-64 pb-8 md:pb-20 lg:pb-32">
      <h1 class="heading-xl leading-[1.25]">Nos ressources pour mieux comprendre la gestion de patrimoine</h1>
    </section>
  </div>

  <!-- Blog Content -->
  <div class="bg-(--color-bg-section)">
    <!-- Blog & Actualités Section -->
    <section class="section !pr-0 pt-12 md:pt-16 lg:pt-20 pb-12 md:pb-16">
      <div class="articles-header">
        <h2 class="heading-lg">Actualités patrimoniales</h2>
        <div class="scroll-arrows" aria-hidden="true">
          <button class="scroll-arrow scroll-arrow--prev" data-dir="prev" aria-label="Défiler vers la gauche">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <button class="scroll-arrow scroll-arrow--next" data-dir="next" aria-label="Défiler vers la droite">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
        </div>
      </div>

      <div class="articles-scroll flex gap-6 overflow-x-auto pr-6 pb-4 mt-8 md:mt-10">
        {blogArticles.map((article) => (
          <article class="shrink-0 w-[280px] md:w-[310px]">
            <a href={`/blog/${article.slug}`}>
              <Image
                src={article.image}
                alt={article.title}
                class="img-cover h-[400px] mb-5"
                widths={[280, 400, 500]}
                sizes="(max-width: 1024px) 280px, 310px"
                loading="lazy"
              />
              <time class="block mb-8">{article.date}</time>
              <p class="text-body">{article.title}</p>
            </a>
          </article>
        ))}
      </div>
    </section>

    <!-- Guides pratiques Section -->
    <section class="section !pr-0 pt-12 md:pt-16 pb-(--spacing-section)">
      <div class="articles-header">
        <h2 class="heading-lg">Guides pratiques</h2>
        <div class="scroll-arrows" aria-hidden="true">
          <button class="scroll-arrow scroll-arrow--prev" data-dir="prev" aria-label="Défiler vers la gauche">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <button class="scroll-arrow scroll-arrow--next" data-dir="next" aria-label="Défiler vers la droite">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
        </div>
      </div>

      <div class="articles-scroll flex gap-6 overflow-x-auto pr-6 pb-4 mt-8 md:mt-10">
        {guidesArticles.map((article) => (
          <article class="shrink-0 w-[280px] md:w-[310px]">
            <a href={`/blog/${article.slug}`}>
              <Image
                src={article.image}
                alt={article.title}
                class="img-cover h-[400px] mb-5"
                widths={[280, 400, 500]}
                sizes="(max-width: 1024px) 280px, 310px"
                loading="lazy"
              />
              <time class="block mb-8">{article.date}</time>
              <p class="text-body">{article.title}</p>
            </a>
          </article>
        ))}
      </div>
    </section>
  </div>
</Layout>

<style>
  .articles-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-right: 1.5rem;
  }

  .scroll-arrows {
    display: none;
    gap: 0.5rem;
  }

  @media (min-width: 768px) {
    .scroll-arrows {
      display: flex;
    }
  }

  .scroll-arrow {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    border-radius: 5px;
    border: 1px solid var(--color-primary);
    background: transparent;
    color: var(--color-primary);
    cursor: pointer;
    transition: all 0.35s;
  }

  .scroll-arrow:hover {
    background: var(--color-primary);
    color: white;
  }

  .scroll-arrow:disabled {
    opacity: 0.3;
    cursor: default;
    background: transparent;
    color: var(--color-primary);
  }

  .articles-scroll {
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }

  .articles-scroll::-webkit-scrollbar {
    display: none;
  }
</style>

<script>
  function initScrollArrows() {
    document.querySelectorAll('.articles-header').forEach((header) => {
      const section = header.parentElement;
      if (!section) return;
      const scroller = section.querySelector('.articles-scroll');
      if (!scroller) return;

      const prevBtn = header.querySelector('[data-dir="prev"]') as HTMLButtonElement;
      const nextBtn = header.querySelector('[data-dir="next"]') as HTMLButtonElement;
      if (!prevBtn || !nextBtn) return;

      function updateButtons() {
        if (!scroller) return;
        prevBtn.disabled = scroller.scrollLeft <= 0;
        nextBtn.disabled = scroller.scrollLeft + scroller.clientWidth >= scroller.scrollWidth - 1;
      }

      prevBtn.addEventListener('click', () => {
        scroller.scrollBy({ left: -340, behavior: 'smooth' });
      });

      nextBtn.addEventListener('click', () => {
        scroller.scrollBy({ left: 340, behavior: 'smooth' });
      });

      scroller.addEventListener('scroll', updateButtons, { passive: true });
      updateButtons();
    });
  }

  initScrollArrows();
  document.addEventListener('astro:after-swap', initScrollArrows);
</script>
